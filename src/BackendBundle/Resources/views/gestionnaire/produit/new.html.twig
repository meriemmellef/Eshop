{% extends '@Backend/layout/layout.html.twig' %}


{% block page %}

  <style>
        input[type='radio'] {
            -webkit-appearance:none;
            width:20px;
            height:20px;
            border:1px solid #e2e2e2;
            border-radius:50%;
            outline:none;
            box-shadow:0 0 1px 0 #e2e2e2 inset;
        }

        input[type='radio']:hover {
            box-shadow:0 0 1px 0 #e2e2e2 inset;
        }

        input[type='radio']:before {
            content:'';
            display:block;
            width:50%;
            height:50%;
            margin: 20% auto;
            border-radius:50%;
        }
        input[type='radio']:checked:before {
            background: #dd1d36;
        }
        li {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }


    </style>

    <div class="page">
        <div class="page-content">
            <!-- Panel -->
            <div class="panel">
                <div class="panel-body container-fluid">
                    <div class="row row-lg">
                        <div class="col-lg-12">
                            <div class="example-wrap">
                                <h4 class="example-title">{{ "Nouveau Produit"|trans }} </h4>
                                <br><br>
                                {% if errort is defined %}
                                    <div class="col-lg-12 text-center">
                                        <div class="alert alert-danger alert-dismissible" role="alert">
                                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                                <span aria-hidden="true">×</span>
                                            </button>
                                            {{ errort|trans }}
                                        </div>
                                    </div>
                                    <br><br>
                                {% endif %}
                                <div class="row row-lg">

                                    {{ form_start(form, {'attr': {'class': 'col-lg-12 '}}) }}
                                    {% if  form.categorie is defined%}
                                        <div class="col-lg-12">
                                            <div class="row row-lg">
                                                <div class="col-lg-3 text-right">
                                                    <label>{{"Catégorie"|trans}}<span style="color: #ED0000">*</span>  :</label>
                                                </div>
                                                <div class="col-lg-6 text-left">
                                                    {{ form_widget(form.categorie, {'attr': {'class': 'form-control'}}) }}
                                                </div>
                                            </div>
                                        </div>

                                        <br><br>
                                    {% endif %}
                                    {% if  form.sous_categorie is defined%}
                                        <div class="col-lg-12">
                                            <div class="row row-lg">
                                                <div class="col-lg-3 text-right">
                                                    <label>{{"Sous Catégorie"|trans}}<span style="color: #ED0000">*</span>  :</label>
                                                </div>
                                                <div class="col-lg-6 text-left">
                                                    {{ form_widget(form.sous_categorie, {'attr': {'class': 'form-control'}}) }}
                                                </div>
                                            </div>
                                        </div>
                                        <br><br>
                                    {% endif %}
                                    {#
                                         {% if  form.stations is defined%}
                                        <div class="col-lg-12">
                                            <div class="row row-lg">
                                                <div class="col-lg-3 text-right">
                                                    <label>{{"stations"|trans}}<span style="color: #ED0000">*</span>  :</label>
                                                </div>
                                                <div class="col-lg-6 text-left">
                                                    {{ form_widget(form.stations, {'attr': {'class': 'form-control'}}) }}
                                                </div>
                                            </div>
                                        </div>
                                        <br><br>
                                    {% endif %}
                                    #}


                                    <div class="col-lg-12">
                                        <div class="row row-lg">

                                            <div class="col-lg-3 text-right">
                                                <label>{{ "Nom"|trans }}<span style="color: #ED0000">*</span>  :</label>
                                            </div>
                                            <div class="col-lg-6 text-left">
                                                {% if pays.frontLanguage  == 'EN' or pays.frontLanguage  == 'en' %}
                                                    {{ form_widget(form.nomen, {'attr': {'class': 'form-control'}}) }}

                                                {% else %}
                                                    {{ form_widget(form.nom, {'attr': {'class': 'form-control'}}) }}

                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                    <br><br>

                                    <div class="col-lg-12">
                                        <div class="row row-lg">

                                            <div class="col-lg-3 text-right">
                                                <label>{{ "Description"|trans }} :</label>
                                            </div>
                                            <div class="col-lg-6 text-left">
                                                {% if  pays.frontLanguage  == 'EN' or pays.frontLanguage  == 'en' %}
                                                    {{ form_widget(form.descriptionen, {'attr': {'class': 'form-control'}}) }}

                                                {% else %}
                                                    {{ form_widget(form.description, {'attr': {'class': 'form-control'}}) }}

                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>

                                    <br><br>

                                    <div class="col-lg-12">
                                        <div class="row row-lg">

                                            <div class="col-lg-3 text-right">
                                                <label>{{ "Prix"|trans }} :</label>
                                            </div>
                                            <div class="col-lg-6 text-left">
                                                {{ form_widget(form.prix, {'attr': {'class': 'form-control'}}) }}
                                                <br>

                                                {#
                                                        {% if not form.vars.valid %}
                                                    {% for child in form.children %}
                                                        {%for error in child.vars.errors%}
                                                            <div class="alert alert-danger alert-dismissible" role="alert">
                                                                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                                                    <span aria-hidden="true">×</span>
                                                                </button>
                                                                {{"le prix n'est pas valide"|trans}}
                                                            </div>
                                                        {%endfor%}
                                                    {%endfor%}

                                                {%endif%}
                                                #}

                                            </div>
                                        </div>
                                    </div>
                                    <br><br>
                                    <div class="col-lg-12">
                                        <div class="row row-lg">
                                            <div class="col-lg-3 text-right">
                                            </div>

                                            <div class="col-lg-6 text-left">
                                                <div class="checkbox-custom checkbox-primary center-block">
                                                    {{ form_widget(form.is_promo, {'attr': {'class': 'form-control'}}) }}
                                                    <label for="inputChecked">{{ "Est Promo"|trans }}?</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-lg-12" id="div_prix_promo">
                                        <br><br>

                                        <div class="row row-lg">
                                            <div class="col-lg-2 text-left">

                                            </div>
                                            <div class="col-xxl-8 col-lg-8">
                                                <!-- Example Tabs In The Panel -->
                                                <div class="panel nav-tabs-horizontal" data-plugin="tabs">
                                                    <ul class="nav nav-tabs nav-tabs-line " role="tablist">

                                                        <li class="nav-item " id="titleeeone" >
                                                            <input  type="radio" id="radPromotionP" name="heatSwitchtwo" value="12" checked />

                                                            <a class="nav-link active"  id="promo_prix"  style="padding: 7px 10px 7px 0px;" data-toggle="tab" href="#promoparprix"
                                                               aria-controls="exampleTopHome" role="tab" aria-selected="true">
                                                                {{ "Promotion par prix"|trans }}
                                                            </a>

                                                        </li>
                                                        <li class="nav-item "  id="titleee">

                                                            <input type="radio" id="radPromotionPor" name="heatSwitchtwo" value="13"  >

                                                            <a class="nav-link" id="promo_pourcentage" style="padding: 7px 10px 7px 0px;" data-toggle="tab" href="#promoparpourcentage" aria-controls="exampleTopComponents" role="tab" aria-selected="false">
                                                                {{ "Promotion en pourcentage"|trans }}
                                                            </a>


                                                        </li>
                                                    </ul>


                                                    <div class="panel-body" style="border: 1px solid #d4d4d4;">
                                                        <div class="tab-content">
                                                            <div class="tab-pane active" id="promoparprix" role="tabpanel">

                                                                <div class="row row-lg">
                                                                    <div class="col-lg-3 text-left" style="padding-right: 0px;padding-left: 4px;">
                                                                        <label>{{ "Prix en promotion"|trans }} :</label>
                                                                    </div>
                                                                    <div class="col-lg-9 text-left">
                                                                        {{ form_widget(form.prix_promo, {'attr': {'class': 'form-control'}}) }}


                                                                    </div>
                                                                </div>

                                                            </div>
                                                            <div class="tab-pane" id="promoparpourcentage" role="tabpanel">
                                                                <div class="col-lg-12">
                                                                    <div class="row row-lg">
                                                                        <div class="col-lg-3 text-left" style="padding-right: 0px;padding-left: 4px;">
                                                                            <label>{{ "Pourcentage de promotion"|trans }}:</label>
                                                                        </div>
                                                                        <div class="col-lg-9 text-left">
                                                                            {{ form_widget(form.poucentage_promo, {'attr': {'class': 'form-control'}}) }}
                                                                            <br>

                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <br><br>
                                                                <div class="col-lg-12">
                                                                    <div class="row row-lg">
                                                                        <div class="col-lg-3 text-left" style="padding-right: 0px;padding-left: 4px;">
                                                                            <label>{{"Numéro de produit à reduire"|trans}}:</label>
                                                                        </div>
                                                                        <div class="col-lg-9 text-left">
                                                                            {{ form_widget(form.num_produit_promo, {'attr': {'class': 'form-control'}}) }}
                                                                            <br>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- End Example Tabs In The Panel -->
                                            </div>
                                        </div>
                                    </div>


                                    <br><br>

                                    <div class="col-lg-12">
                                        <div class="row row-lg">
                                            <div class="col-lg-3 text-right">
                                                <label>{{ "Image"|trans }} <span style="color: #ED0000">*</span> :</label>
                                            </div>
                                            <div class="col-lg-6 text-left">
                                                {{ form_widget(form.imagefile, {'attr': {'id': 'input-file-now', 'data-plugin':'dropify','data-default-file': '','style' : 'max-height: 100px;max-width:300px'}}) }}
                                                <h6 style="color: #ED0000">{{ "image"|trans }} ( 400 × 352 px ) {{ "maxsize"|trans }} (1024k)</h6>

                                            </div>
                                        </div>
                                    </div>

                                    <br><br>
                                    <div class="col-lg-12">
                                        <div class="row row-lg">
                                            <div class="col-lg-3 text-right">
                                                <label>{{"Fichetechnique"|trans}}:</label>
                                            </div>
                                            {#
                                                <div class="col-lg-6 text-left">
                                                {{ form_widget(form.file, {'attr': {'class': 'form-control'}}) }}
                                                {{ form_errors(form.file) }}

                                            </div>
                                            #}


                                            <div class="col-lg-6 text-left input-group input-group-file "
                                                 data-plugin="inputGroupFile">

                                                <input type="text" class="form-control" readonly=""
                                                       id="input_cgu_file_upload">


                                                <span class="input-group-btn">
                                                <span class="btn btn-default btn-file waves-effect waves-classic">
                                                 <i class="icon md-upload" aria-hidden="true"></i>

                                                {{ form_widget(form.file, {'attr': {'class': 'form-control'}}) }}
                                                    {{ form_errors(form.file) }}
                                                    {% if produit %}<a target="_blank" href="{{ legal_notice_directory }}/{{ produit.file }}">{{ produit.file }}</a>{% endif %}
                                                  </span>
                                                    </span>
                                            </div>
                                        </div>
                                    </div>

{#RAHLMMMMMM#}
                                    <br><br>

                                    <div class="col-lg-12" id="divcouleur" >


                                    </div>
                                    <div class="col-lg-12">
                                        <div class="row row-lg">
                                            <div class="col-lg-4">
                                            </div>
                                            <div class="col-lg-6 " id="divbtnadd" style="margin-top: -33px; ">
                                                <button type="button" onclick="adddivcouleur()"
                                                        class="btn social-evernote  waves-effect waves-classic">
                                                    <i class="icon md-plus"></i> {{ "Ajouter une couleur"|trans }}
                                                </button>
                                            </div>

                                        </div>
                                    </div>
{#RAHLMMMMMM#}



                                    <br><br>
                                    <div class="col-lg-12">
                                        <div class="row row-lg">
                                            <div class="col-lg-3 text-right">
                                            </div>

                                                <div class="col-lg-6 text-left">
                                                    <div class="checkbox-custom checkbox-primary center-block">
                                                        {{ form_widget(form.is_active, {'attr': {'class': 'form-control'}}) }}
                                                        <label for="inputChecked">{{ "Est Active"|trans }}?</label>
                                                    </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br><br>

                                    <div class="col-lg-12">
                                        <div class="row row-lg">
                                            <div class="col-lg-3 text-right">
                                            </div>

                                            <div class="col-lg-6 text-left">
                                                <div class="checkbox-custom checkbox-primary center-block">
                                                    {{ form_widget(form.isActiveInAllStation, {'attr': {'class': 'form-control'}}) }}
                                                    <label for="isActiveInAllStation">{{ "is_active_in_all_station"|trans }}?</label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>






                                    <br><br>
                                    {#
                                        <div class="col-lg-12 text-center">
                                        <button class="btn social-evernote  waves-effect waves-classic">{{ 'Enregistrer'|trans }}</button>
                                    </div>
                                    #}


                                    <div class="col-lg-12 text-center">

                                        <div class="row">
                                            <div class="col-lg-6 text-right">
                                                <button class="btn md-edit social-evernote  waves-effect waves-classic">{{ 'Enregistrer'|trans }}</button>

                                            </div>
                                            <div class="col-lg-6 text-left">
                                                <a href="{{ path('produit_index') }}" style=" background-color: #ed0000 !important;  border-color: #ed0000!important;"  class="btn   btn-danger waves-effect waves-classic">{{ 'back'|trans }}</a>
                                            </div>
                                        </div>
                                    </div>
                                    {{ form_end(form) }}

                                    <br>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


{% endblock %}
{% block javascripts %}
    {{ parent() }}
    {#
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet" />

        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

was     <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min.js"></script>

    #}

    <script src="{{ asset('remark/global/js/Plugin/input-group-file.js')}}"></script>


    <script type="text/javascript">
        $("#produit_file").change(function () {
            // alert($("#pays_cgu_file_upload").val());
            content = $("#produit_file").val();
            $('#input_cgu_file_upload').val(content);
        });

        //div_prix_promo   is_promo

        if ($('#produit_is_promo').is(":checked"))
        {
            // it is checked
            $("#div_prix_promo").show()

        }else {
            $("#div_prix_promo").hide()

            console.log("hi bb not checked")
            ///all promo field not required
            $('#produit_prix_promo').prop('required',false);
            $('#produit_poucentage_promo').prop('required',false);
            $('#produit_num_produit_promo').prop('required',false);

        }


    </script >
    <script>
//            document.getElementById("inputprix").required = true;


$("document").ready(function(){
            $('#radPromotionP').on("click",function(){
                 console.log("promo_prix")
            //    $('#produit_poucentage_promo').val('');
            //    $('#produit_num_produit_promo').val('');
                $("#radPromotionP").prop("checked", true);
                $("#radPromotionPor").prop("checked", false);
                $('#titleeeone').find('a').trigger('click');


                $('#produit_prix_promo').prop('required',true);
                $('#produit_poucentage_promo').prop('required',false);
                $('#produit_num_produit_promo').prop('required',false);

            })

            $('#radPromotionPor').on("click",function(){
              console.log("promo_pourcentage")

           //     $('#produit_prix_promo').val('');
                $("#radPromotionP").prop("checked", false);
                $("#radPromotionPor").prop("checked", true);
                $('#titleee').find('a').trigger('click');



                $('#produit_prix_promo').prop('required',false);
                $('#produit_poucentage_promo').prop('required',true);
                $('#produit_num_produit_promo').prop('required',true);

            })

            $('#produit_is_promo').change(function() {
                if(this.checked) {
                    $("#div_prix_promo").show()
                    $('#produit_prix_promo').prop('required',true);
                    $('#produit_poucentage_promo').prop('required',false);
                    $('#produit_num_produit_promo').prop('required',false);

                }else {
                    $("#div_prix_promo").hide()
                    $('#produit_prix_promo').prop('required',false);
                    $('#produit_poucentage_promo').prop('required',false);//was true
                    $('#produit_num_produit_promo').prop('required',false);//was true

                }
            });


           $('#promo_prix').on("click",function(){

         //       $('#produit_poucentage_promo').val('');
          //      $('#produit_num_produit_promo').val('');

             $("#radPromotionP").prop("checked", true);
             $("#radPromotionPor").prop("checked", false);


               $('#produit_prix_promo').prop('required',true);
               $('#produit_poucentage_promo').prop('required',false);
               $('#produit_num_produit_promo').prop('required',false);


           })

            $('#promo_pourcentage').on("click",function(){
            //    $('#produit_prix_promo').val('');

            $("#radPromotionP").prop("checked", false);
             $("#radPromotionPor").prop("checked", true);


                $('#produit_prix_promo').prop('required',false);
                $('#produit_poucentage_promo').prop('required',true);
                $('#produit_num_produit_promo').prop('required',true);


            })

            $("#produit_poucentage_promo").change(function(){
                //does some stuff;
                $('#produit_prix_promo').val('');
            });
            $("#produit_prix_promo").change(function(){
                //does some stuff;
                $('#produit_poucentage_promo').val('');
                $('#produit_num_produit_promo').val('');
            });





           // $("select").select2();
            if ($("select").length > 0)
                $("select").select2();

        })

//

        $( "select[name='produit[categorie]']" ).change(function () {
            var matiereID = $(this).val();
           // console.log('rahmaaaaaa');
           // console.log('aaaaa');
            console.log(matiereID);

            if(matiereID) {


                $.ajax({
                    url: "{{ path('get_sous_categorie_from_categorie') }}",
                    dataType: 'Json',
                    data: {'categorieid':matiereID},
                    type:'GET',
                    success: function(data) {
                        $('select[name="produit[sous_categorie]"]').empty();
                        $('select[name="produit[sous_categorie]').append('<option value="" selected hidden>'+ 'choisir une sous categorie' +'</option>');

                        for(i = 0; i < data.length; i++) {
                            student = data[i];
                            $('select[name="produit[sous_categorie]').append('<option value="'+ student['id'] +'">'+ student['nom'] +'</option>');
                        };

                    }
                });

                (function (document, window, $) {
                    $("select").select2();
                })(document, window, jQuery);
            }else{
                $('select[name="produit[sous_categorie]"]').empty();
                (function (document, window, $) {
                    $("select").select2();
                })(document, window, jQuery);
            }
        });

    </script>


    <script>
        function updatequantityofsize(id){
            var quantity = parseInt(  $("#quantityofsize"+id).val());
            //console.log(quantity)
            if(quantity> 0){
                $.ajax({
                    url: "{{ path('edit_size') }}",
                    dataType: 'Json',
                    data: {'id':id,'quantite':quantity},
                    type:'GET',
                    success: function(data) {
                        $("#quantityofsize"+id).val(quantity);
                        alert("la quantité est modifiée avec succes")
                    }
                });

            }
            else{
                alert("la quantité doit ètre >0")
            }
        }
        var couleur = -1;

        function adddivcouleur(){
            divinitial=document.getElementById('divbtnadd').style.marginTop = "15px";
            divinitial=document.getElementById('divbtnadd').style.paddingLeft = "0px";
              console.log("cooooleur"+couleur);
           if (  parseInt( $("#couleur").val()) == "undefined" || isNaN(parseInt( $("#couleur").val()))) {
               couleur++
               console.log("couleurplus"+couleur);


           }else {
                couleur = parseInt( $("#couleur").val()) +  1;
              // console.log("couleparsint"+couleur);

            }


            //var couleur =  +1;

            const div = document.createElement('div');
            div.className = 'row row-lg';
            div.style='padding-top: 10px';
            div.id='rowcouleur';
            div.innerHTML =
                '<div class="col-lg-12">'+
                '<div class="row row-lg">'+

                '<div class="col-lg-4 text-left"> ' +
                '<input type="color" class="form-control" name="couleurs[]"> ' +
                '<input type="text" class="form-control" name="couleur'+couleur+'" value="'+couleur+'" hidden>' +
                '</div>' +
                '<div class="col-lg-8 text-left"> ' +
                '<div class="input-group input-group-file" data-plugin="inputGroupFile"> ' +
                '<input type="text" class="form-control" readonly=""> ' +
                '<span class="input-group-btn"> ' +
                '<span class="btn btn-default btn-file waves-effect waves-classic"> ' +
                '<i class="icon md-upload" aria-hidden="true"></i> ' +
                '<input type="file"  accept="image/*" name="images[]" > ' +
                '</span> ' +
                '</span> ' +
                '</div> ' +
                '</div> ' +
                '<div class="col-lg-2 text-left"> </div>'+
                '</div> '+
                '</div> ' ;

            const divsize = document.createElement('div');

            divsize.className = 'row row-lg';
            divsize.style='padding-top: 10px';
            divsize.id='rowsize'+couleur;
            divsize.innerHTML =
                '<div class="col-lg-12">'+
                '<div class="row row-lg">'+
                '<div class="col-lg-4 text-right">' +
                '<input type="text" class="form-control" name="sizes'+couleur+'[]" placeholder="size">'+
                // '<select class="form-control" id="sizes" style="text-align-last: center" name="sizes'+couleur+'[]" > ' +
                //   '{% for key,size in produit.sizeValue %}'+
                //  ' <option value="{{ key }}"  >{{ size }}</option>'+
                //  '  {% endfor %}'+
                //   '  </select>'+
                '  </div>'+
                '  <div class="col-lg-8 text-left">'+
                '  <span class="input-group-btn">'+
                ' <input type="number" min="0" class="form-control" name="quantity'+couleur+'[]" value="0">'+
                '<button type="button" style="border-top-left-radius: 0;border-bottom-left-radius: 0;" onclick="adddivsize('+couleur+')" class="btn social-evernote waves-effect waves-classic">' +
                '<i class="icon md-plus"></i>' +
                '</button>'+
                '   </span>'+
                '  </div>'+
                '  <div class="col-lg-3 text-left">'+
                '   </div>'+
                '   </div>'+
                '   </div>';


            const divrow = document.createElement('div');
            divrow.className = 'row row-lg';
            divrow.style='padding-top: 10px';
            divrow.innerHTML =
                '<div class="col-lg-4 text-right"></div>' +
                '<div class="col-lg-6 text-right" style="border: 1px solid #dcdcdc;padding: 15px 15px 15px 15px;" >' +
                div.outerHTML+
                divsize.outerHTML+
                ' </div>';


            document.getElementById('divcouleur').appendChild(divrow);
            $("#couleur").val(couleur)
        }
        function adddivsize(i){
            var couleur = parseInt(  $("#couleur").val());
            console.log("couleur"+couleur)
            console.log(couleur)
            const div = document.createElement('div');
            div.className = 'col-lg-12';
            div.style='padding-top: 10px';
            div.innerHTML =

                '<div class="row row-lg">'+
                '<div class="col-lg-4 text-right">' +
                '<input type="text" class="form-control" name="sizes'+i+'[]" placeholder="size">'+
                //    '<select class="form-control" id="sizes" style="text-align-last: center" name="sizes'+i+'[]" > ' +
                //    '{% for key,size in produit.sizeValue %}'+
                //   ' <option value="{{ key }}"  >{{ size }}</option>'+
                //   '  {% endfor %}'+
                //   '  </select>'+
                '  </div>'+
                '  <div class="col-lg-8 text-left">'+
                '  <span class="input-group-btn">'+
                ' <input type="number" min="0" class="form-control" name="quantity'+i+'[]" value="0">'+
                '   </span>'+
                '  </div>'+
                '  <div class="col-lg-3 text-left">'+
                '   </div>'+
                '   </div>';
            document.getElementById('rowsize'+i).appendChild(div);
        }

    </script>
{% endblock %}
